define([
  'modules/witness',
  'bonzo',
  'modules/$'
], function(Witness, bonzo, $){

  describe('Witness', function(){
    var sandbox;

    before(function(){
      sandbox = bonzo(bonzo.create('<div id="sandbox" style="visibility:hidden;"></div>'));
      sandbox.appendTo(document.body);
    });

    it('exists', function(){
      expect(Witness).to.be.defined;
    });

    it('duplicate the button at the end of articles', function(){
      var demoArticle = bonzo.create('<div class="article article--standard" id="standard-article-container">        <div class="article__header" id="article-header">            <div class="section section__container" id="section"><div class="content__labels">World</div><div class="content__series-label content__labels"><a href="x-gu://list/"><span> </span></a></div></div>            <h1 class="headline selectable" id="headline">Cuba ferry services to resume from US </h1>            <div class="standfirst selectable" id="standfirst"><p>Florida operators receive approval to relaunch services to Havana as island prepares to officially receive American tourists after 56 years </p></div>            <div class="meta" id="meta">                <div class="meta__misc">                    <div class="meta__byline">                        <a class="alerts " href="x-gu://follow/tag-contributor///profile/jessica-elgot" data-follow-alert-id="tag-contributor///profile/jessica-elgot">    <span class="alerts__state--unfollow">        <span data-icon="" aria-hidden="true"></span>        <span class="alerts__label">Follow contributor</span>    </span>    <span class="alerts__state--follow">        <span data-icon="" aria-hidden="true"></span>        <span class="alerts__label">Following contributor</span>    </span></a>                        <span class="byline" id="byline"><span class="byline__author" id="byline-author"><a href="x-gu://list/localhost/lists/tag/profile/jessica-elgot">Jessica Elgot</a></span></span>                    </div>                    <p class="meta__pubdate"><span class="screen-readable" id="pubdate">Published: </span>14:27 GMT+1 Wednesday, 06 May 2015</p>                </div>                <div class="meta__comments">    <a href="#comments" data-scroll="">        <span data-icon="" aria-hidden="true"></span> 4        <span class="meta__comments__label">Comments</span>    </a></div>            </div>            <div class="main-media" id="main-media">                <figure class="element element-placeholder figure-wide">    <a class="element__inner" href="x-gu://playvideo/cdn.theguardian.tv/HLS/2015/05/06/20150506CubaFerry_FromGuAmRM/20150506CubaFerry_FromGuAmRM.m3u8">        <img src="http://images.mobile-apps.guardianapis.com/static/sys-images/Guardian/Pix/pictures/2015/5/6/1430921200377/Ferry-from-Havana-to-Flor-004.jpg?width=2000&amp;height=1200&amp;quality=60" style="width: 100%;">        <span class="element-placeholder__button touchpoint">            <span class="touchpoint__button" data-icon="" aria-hidden="true" id="video-play-button"></span>            <span class="touchpoint__label"><span class="screen-readable">Play Video. Duration: </span>00:52</span>        </span>    </a></figure>            </div>            <div class="extras">                <aside class="witness">    <a class="witness__button" href="x-gu://witness/5536849ce4b0574bd49be6d1">    Contribute with     </a>    <div class="witness__sponsor">    <svg xmlns="http://www.w3.org/2000/svg" viewBox="-0.38 -1.8 136 62"><path fill="#059098" d="M118.7 0c-9.4 0-16.6 7.6-16.6 16.5 0 7.9 5.1 12.1 5.1 12.1.5.4.4.7 0 1 0 0-5.2 4.7-5.2 11.9 0 9.9 8 16.7 16.6 16.7 9.7 0 16.5-7.9 16.5-16.5 0-7.5-5-11.9-5-11.9-.7-.7-.7-.8 0-1.4 0 0 5-4.2 5-11.9.2-8.8-6.9-16.5-16.4-16.5zM115 8.6c.5 0 .9.2 1.1.6.2-.4.7-.6 1.1-.6.5 0 1 .3 1.2.8.2-.5.7-.8 1.2-.8s1 .3 1.2.8c.2-.5.7-.8 1.2-.8.7 0 1.3.6 1.3 1.4s-.6 1.4-1.3 1.4c-.5 0-1-.3-1.2-.8-.2.5-.7.8-1.2.8s-1-.3-1.2-.8c-.2.5-.7.8-1.2.8s-.9-.2-1.1-.6c-.1.1-.2.3-.4.4.3.2.6.6.6 1.1 0 .5-.2.9-.6 1.1.3.2.6.6.6 1.1 0 .5-.2.9-.6 1.1l.3.3c.2-.3.6-.5 1.1-.5.5 0 .9.3 1.2.7.2-.4.7-.7 1.2-.7s.9.3 1.2.6c.2-.4.7-.6 1.2-.6.7 0 1.3.6 1.3 1.3 0 .7-.6 1.4-1.3 1.4-.5 0-.9-.3-1.2-.6-.2.4-.7.6-1.2.6s-.9-.3-1.2-.7c-.2.4-.7.7-1.2.7-.4 0-.8-.2-1.1-.5l-.3.3c.3.2.6.6.6 1.1 0 .5-.2.9-.6 1.1.3.2.6.6.6 1.1s-.2.9-.6 1.1c.1.1.3.2.4.4.2-.4.7-.6 1.1-.6.5 0 1 .3 1.2.8.2-.5.7-.8 1.2-.8s1 .3 1.2.8c.2-.5.7-.8 1.2-.8.7 0 1.3.6 1.3 1.4s-.6 1.4-1.3 1.4c-.5 0-1-.3-1.2-.8-.2.5-.7.8-1.2.8s-1-.3-1.2-.8c-.2.5-.7.8-1.2.8s-.9-.2-1.1-.6c-.2.4-.7.6-1.1.6-.7 0-1.3-.6-1.3-1.4 0-.5.2-.9.6-1.1-.4-.2-.6-.6-.6-1.1s.2-.9.6-1.1c-.4-.2-.6-.7-.6-1.1 0-.5.2-.9.6-1.1-.4-.2-.6-.7-.6-1.1s.2-.9.6-1.1c-.3-.2-.6-.6-.6-1.1 0-.5.2-.9.6-1.1-.3-.2-.6-.6-.6-1.1 0-.5.2-.9.6-1.1-.4-.2-.6-.6-.6-1.1 0-1.1.6-1.7 1.3-1.7zm0 25.1c.5 0 .9.2 1.1.6.2-.4.7-.6 1.1-.6.5 0 1 .3 1.2.8.2-.5.7-.8 1.2-.8s1 .3 1.2.8c.2-.5.7-.8 1.2-.8.7 0 1.3.6 1.3 1.4s-.6 1.3-1.3 1.3c-.5 0-1-.3-1.2-.8-.2.5-.7.8-1.2.8s-1-.3-1.2-.8c-.2.5-.7.8-1.2.8s-.9-.2-1.1-.6c-.1.1-.2.3-.4.4.4.2.6.7.6 1.1 0 .5-.2.9-.6 1.1.3.2.6.6.6 1.1 0 .5-.2.9-.6 1.1l.3.3c.2-.3.6-.5 1.1-.5.5 0 .9.3 1.2.7.2-.4.7-.7 1.2-.7s.9.3 1.2.6c.2-.4.7-.6 1.2-.6.7 0 1.3.6 1.3 1.4s-.6 1.4-1.3 1.4c-.5 0-.9-.3-1.2-.7-.2.4-.7.7-1.2.7s-.9-.3-1.2-.7c-.2.4-.7.7-1.2.7-.4 0-.8-.2-1.1-.5l-.3.3c.3.2.6.7.6 1.1 0 .5-.2.9-.6 1.1.4.2.6.7.6 1.1s-.2.9-.6 1.1c.1.1.3.2.4.4.2-.4.7-.6 1.1-.6.5 0 1 .3 1.2.8.2-.5.7-.8 1.2-.8s1 .3 1.2.8c.2-.5.7-.8 1.2-.8.7 0 1.3.6 1.3 1.3s-.6 1.4-1.3 1.4c-.5 0-1-.3-1.2-.8-.2.5-.7.8-1.2.8s-1-.3-1.2-.8c-.2.5-.7.8-1.2.8s-.9-.2-1.1-.6c-.2.4-.7.6-1.1.6-.7 0-1.3-.6-1.3-1.3 0-.5.2-.9.6-1.1-.4-.2-.6-.7-.6-1.1 0-.5.2-.9.6-1.1-.3-.2-.6-.6-.6-1.1s.2-.9.6-1.1c-.4-.2-.6-.6-.6-1.1 0-.5.2-.9.6-1.1-.3-.2-.6-.6-.6-1.1 0-.5.2-.9.6-1.1-.3-.2-.6-.6-.6-1.1 0-.5.2-.9.6-1.1-.3-.2-.6-.7-.6-1.1 0-1.1.6-1.7 1.3-1.7z"></path><path class="witness__sponsor-logo" d="M10.2 20.4c-.1 1.5-.6 2.6-1.5 3.4-1.8 1.7-4.7 1.5-6.8.5v4.1c0 .3-.1.5-.3.7-.4.4-1 .4-1.3 0-.2-.2-.3-.5-.3-.7v-12c0-.7-.1-1.5.1-2.2.5-1.1 3-1.5 4-1.7 1.6-.2 3.4 0 4.6 1.2 1.8 1.8 1.5 4.4 1.5 6.7zm-1.9-3.2c-.3-3.5-3.9-3.7-6.4-2.1v7.3c1.5.9 4.1 1.5 5.5.1.8-.8.9-2.1.9-3.2 0-.5.1-1.3 0-2.1zm10.3-4.8c1.3 0 2.6.4 3.6 1.3.5.4.8.9 1.1 1.5.9 1.8.9 5.2 0 7.1-.3.6-.6 1.1-1.1 1.5-.5.4-1 .7-1.6 1-1.3.5-2.7.5-4 0-.6-.2-1.2-.6-1.6-1-.5-.4-.8-.9-1.1-1.5-.8-1.8-.8-5.3 0-7.1.3-.6.6-1.1 1.1-1.5.9-.9 2.3-1.3 3.6-1.3zm0 1.8c-1 0-1.8.3-2.3.8-.6.6-.9 1.3-1 2.1-.1 1-.1 2 0 3.1.1.9.4 1.7 1 2.2 1.2 1.1 3.4 1.1 4.6 0 .6-.6.9-1.3 1-2.2v-3.1c-.1-.9-.4-1.6-1-2.1-.6-.6-1.4-.8-2.3-.8zm16.4.5l-.1-.1-.1.1-1.3 5c-.3 1.2-.6 4.1-1.7 5-.6.5-1.5.5-2.1 0-.6-.4-.7-1.3-.9-2l-.9-3.4-1.5-5.6c-.1-.4-.1-.7.1-.9.3-.4.9-.5 1.3-.2s.5 1.2.6 1.7l.9 3.3c.5 1.8 1 3.6 1.4 5.3l.1.1.1-.1 1.3-5 .8-3.1c.2-.7.3-1.6.9-2.1.6-.5 1.5-.5 2.1 0 .6.5.7 1.3.9 2 .3 1.1.6 2.2.8 3.2l1.3 5 .1.1.1-.1c.4-1.7.9-3.4 1.3-5l.9-3.4c.1-.5.2-1.6.7-1.9.8-.7 1.7.3 1.5 1.2l-1.5 5.3c-.3 1.2-.6 2.3-1 3.5-.2.7-.3 1.6-.9 2.1-.6.5-1.5.5-2.1 0-1.1-.9-1.4-3.8-1.7-5l-.9-3.3-.5-1.7zm21.1 3.4c-.1.5-.1.7-.3 1-.4.4-3.1.4-4 .4h-4c0 1.1.1 2.2 1 2.9.8.7 1.9 1 2.9.9 1-.1 2.1-.8 3-.7 0 0 .5 0 .7.4s.1.7 0 .8c-.1.1-.2.3-.4.4-2.1 1.2-5.7 1.1-7.5-.6-.5-.4-.8-1-1-1.6-.8-1.9-.8-5 .1-6.9.3-.6.6-1.1 1.1-1.5.4-.4 1-.7 1.6-1 1.3-.5 2.8-.5 4.1 0 .6.2 1.2.6 1.6 1.1.4.4.8 1 1 1.6.2 1.4.2 2.3.1 2.8zm-2.1-.2c.2 0 .3-.1.3-.3 0-.5 0-1-.1-1.4-.1-.4-.3-.8-.6-1.1-.3-.3-.6-.6-1-.7-1.2-.5-3-.3-3.9.8-.6.7-.8 1.6-.8 2.8-.1-.1 6.1-.1 6.1-.1zm11.4-5.3c.7.2 1 .9.5 1.5-.5.7-1.9.1-2.6.1-.7 0-1.1.2-1.4.5-.9.9-.5 3.4-.5 4.6v4.6c0 .3-.1.5-.3.7-.6.6-1.6.2-1.6-.7V19c0-1.8-.4-4.3 1-5.7 1.2-1.1 3.4-1.2 4.9-.7.5.2-.2 0 0 0zm12.8 5.5c0 .4-.1.7-.3 1-.5.6-3.1.4-4 .4h-4c0 1.1.1 2.2 1 2.9.7.6 1.6.9 2.5.9 1.1 0 2.3-.8 3.4-.7 0 0 .5.1.7.4s.1.7 0 .8c-.1.1-.2.3-.4.4-1.6.9-4.2 1-5.9.4-.6-.2-1.2-.6-1.6-1-.5-.4-.8-1-1.1-1.6-.8-1.9-.8-5 .1-6.9.3-.6.6-1.1 1.1-1.5.4-.4 1-.7 1.6-1 1.3-.5 2.8-.5 4.1 0 1.2.5 2.1 1.4 2.6 2.6.2 1.5.1 2.5.2 2.9zm-2.2-.2c.2 0 .3-.1.3-.3 0-.5 0-1-.1-1.4-.1-.4-.3-.8-.6-1.1-.3-.3-.6-.6-1-.7-1.3-.5-3-.3-3.9.8-.6.7-.8 1.6-.8 2.8-.1-.1 6.1-.1 6.1-.1zm5.3-.9c.1-1.5.6-2.6 1.4-3.4 1.8-1.7 4.8-1.4 6.8-.5V9.2c0-.3.1-.5.3-.7.4-.4 1-.4 1.4 0 .2.2.3.4.3.7V21c0 .7.1 1.5-.1 2.3-.4 1-2.6 1.4-3.4 1.6-1.7.4-3.8.2-5.2-1.1-1.1-1.1-1.5-2.6-1.5-4.2V17zm1.9 3.2c.3 3.4 3.9 3.7 6.4 2.1V15c-1.4-.9-4.2-1.4-5.5-.1-1.3 1.3-.9 3.6-.9 5.3zM43.8 41c.1 2.3.3 5-1.5 6.8-1.3 1.3-3.4 1.5-5.2 1.1-.8-.2-3.1-.6-3.4-1.6-.1-.5-.1-6.7-.1-6.7v-7.4c0-.8 1-1.3 1.6-.7.2.2.3.4.3.7v3.9c2.1-.9 5.1-1.3 6.8.5.9.8 1.4 2 1.5 3.4zm-1.9 3.2c.1-1.6.4-4-.8-5.3-1.3-1.4-4.1-.8-5.5.1v7.3c.9.6 2 1 3.1 1 1.9 0 3-1 3.2-3.1zm4.2-6.3c-.1-.4-.1-.7.1-.9.3-.4 1-.6 1.4-.2 1 .9 1.5 3.1 2 4.3.7 1.5 1.3 3 2 4.6.1.1.1.1.2 0 .6-1.5 1.2-2.9 1.7-4.4.4-.9.7-1.8 1.1-2.8.2-.5.4-1.3.8-1.6.4-.4 1.1-.2 1.4.2.2.3.2.6.1.9l-2.8 6.9c-1.1 2.7-2.2 6.6-4.8 8.2-.5.3-1.1.4-1.5 0-1.1-1 1.2-2.2 1.7-2.7.5-.6.9-1.3 1.2-2.3-.2 0-4.6-10.2-4.6-10.2zm44.3-5.4c.8 0 1.3 1 .7 1.6-.2.2-.4.3-.7.3h-7.8v5.4h7.6c.3 0 .5.1.7.3.4.3.3.9 0 1.3-.2.2-.4.3-.7.3h-7.6V47h7.7c.3 0 1.1.2 1.1.9s-.7 1-1.2 1h-7.9c-.5 0-.9-.2-1.2-.5-.6-.7-.4-2-.4-2.8V36c0-.9-.1-2.4.4-3 .6-.6 1.5-.4 4.7-.5h4.6zm-14.6 0c.8 0 1.3 1 .7 1.6-.2.2-.4.3-.7.3H68v5.4h7.6c.3 0 .5.1.7.3.4.3.3.9 0 1.3-.2.2-.4.3-.7.3H68V47h7.7c.3 0 1.1.2 1.1.9s-.7 1-1.2 1h-7.9c-.5 0-.9-.2-1.2-.5-.6-.7-.4-2-.4-2.8V36c0-.9-.1-2.4.4-3 .6-.6 1.5-.4 4.7-.5h4.6z"></path></svg>    </div></aside>                <div class="sponsorship"> <p class="sponsorship__formatted-sponsor-name">   <span>Guardian Cities is supported by: </span><a href="http://www.100resilientcities.org">The Rockefeller Foundation</a>  </p>  <a class="sponsorship__about-uri" href="x-gu://item/mobile-apps.guardianapis.com/items/cities/2014/jan/27/cities-about-this-site">    About this content  </a></div>            </div>        </div>        <div class="article__body" id="article-body">            <div class="from-content-api prose resizable selectable" id="article-body-blocks">                <div class="advert-slot advert-slot--mpu advert-slot--mpu--tablet"><div class="advert-slot__label">Advertisement<a class="advert-slot__action" href="x-gu://subscribe">Hide<span data-icon=""></span></a></div><div class="advert-slot__wrapper" id="advert-slot__wrapper"><div class="advert-slot__wrapper__content" id="advert-mpu-content"></div></div></div><p>When ferry services last ran to Cuba from the US, Mack the Knife was in the charts and there were no McDonald’s restaurants outside America. </p> <p>Cuba still doesn’t have a branch of the burger chain – well, outside of Guantánamo Bay – but it could soon have its ferry back after more than half a century, as the Obama administration approved the reinstatement of a service between Florida and Havana.</p> <p>Cuba is yet to approve any immediate recommencement of the service, and it is unclear if the administration there would look favourably on a significant new route for people and goods to move between the US and its island neighbour. </p> <p>But things are moving on the US end. Baja Ferries, a Mexico-based passenger service, has received a licence from the US Treasury Department to run an overnight service. </p> <p><a href="http://www.sun-sentinel.com/business/tourism/fl-havana-ferry-approval-20150505-story.html">The Sun-Sentinel newspaper in Florida</a> reported approvals had also been received by Havana Ferry Partners, of Fort Lauderdale; United Caribbean Lines Florida, in the Orlando area; and Airline Brokers Co, of Miami.</p> <p><a href="https://www.facebook.com/pages/Havana-Ferry-Partners-LLC/215566788505329?fref=ts">Havana Ferry Partners wrote on its Facebook page</a>: “This is a historical event. Thanks to President Barack Obama, to whom we are very grateful, for his leadership.” </p> <p>Airline Brokers posted its approval notice on its Facebook page, adding that it had waited since 1991.</p> <figure class="element element-image figure-wide" data-media-id="cf42050a3415c78727f3f709d7f28ca58339e938">  <a href="x-gu://gallery/http://images.mobile-apps.guardianapis.com/media/cf42050a3415c78727f3f709d7f28ca58339e938/0_306_5184_3112/5184.jpg?width=#{width}&amp;height=#{height}&amp;quality=#{quality}"><img src="http://media.guim.co.uk/cf42050a3415c78727f3f709d7f28ca58339e938/0_306_5184_3112/1000.jpg" alt="Tourists take in the sights from a tour bus of Havana. Cuba is ready to welcome American visitors legally after half a century." width="1000" height="600" class="gu-image" style="width: 100%;"></a>  <figcaption>   <span class="element-image__caption">Tourists take in the sights from a tour bus of Havana. Cuba is ready to welcome American visitors legally after half a century.</span>   <span class="element-image__credit">Photograph: Joe Raedle/Getty</span>  </figcaption> </figure> <p>Robert Muse, a lawyer for Baja Ferries, told Associated Press that the new service could provide a much cheaper way for travellers to visit the two countries, and provide a vital method of transporting imported goods now legal via new loopholes in the trade embargo. <br></p> <p>Muse said it was “a further indication of the seriousness of the Obama administration in normalising relations with Cuba, we’re now going from the theoretical to the very specific”.</p> <p>Before the 1959 revolution, daily ferries used to run, with tourists visiting the beachfront hotels and casinos of Havana, and the large expat Cuban community shuttling the 315 miles from south Florida to see family, friends and <a href="http://www.npr.org/2014/12/27/373393516/for-cubans-in-key-west-a-longing-to-fill-in-gaps-of-who-we-are">even seek medical or dental treatment</a>.<br></p> <p>The New York-based airline JetBlue said this week it would offer weekly flights from JFK airport to Havana from 3 July, the first carrier to announce a new service since restrictions were eased.</p> <p>For decades, private charter flights were the only way for the <a href="http://www.npr.org/blogs/parallels/2014/06/24/324898879/with-cash-and-fat-fryers-americans-feed-cubas-growing-free-market">600,000 travellers who make the journey each year</a>, 80% of them Cuban-Americans visiting relatives. But tourism is on the rise, particularly after Obama’s announcement in December that the trade embargo would be relaxed. </p> <p>Around 30,000 Americans currently travel purely for the purposes of tourism to the country every year, which is still officially illegal, although pressure groups are campaigning for this restriction to also be lifted.</p>                            </div>        </div>        <div class="tags" id="tags">            <ul class="inline-list" id="tag-list">                <li class="inline-list__item screen-readable">Tags:</li>            <li class="inline-list__item"><a href="x-gu://list/localhost/lists/tag/world/cuba">Cuba</a></li><li class="inline-list__item"><a href="x-gu://list/localhost/lists/tag/us-news/us-foreign-policy">US foreign policy</a></li><li class="inline-list__item"><a href="x-gu://list/localhost/lists/tag/us-news/us-news">US news</a></li><li class="inline-list__item"><a href="x-gu://list/localhost/lists/tag/travel/cuba">Cuba</a></li><li class="inline-list__item"><a href="x-gu://list/localhost/lists/tag/world/americas">Americas</a></li><li id="more-tags-contaier" class="inline-list__item more-button js-more-button"><a id="more">More...</a></li><li class="inline-list__item hide-tags"><a href="x-gu://list/localhost/lists/tag/travel/northandcentralamerica">North and Central America</a></li><li class="inline-list__item hide-tags"><a href="x-gu://list/localhost/lists/tag/travel/travel">Travel</a></li><li class="inline-list__item hide-tags"><a href="x-gu://list/localhost/lists/tag/world/world">World news</a></li><li class="inline-list__item hide-tags"><a href="x-gu://list/localhost/lists/tag/profile/jessica-elgot">Jessica Elgot</a></li></ul>        </div>    </div>').pop();
      $(demoArticle).appendTo(sandbox);
      Witness.duplicate();
      expect($('.witness').length).to.be.equal(2);
    });

    it('does not duplicate if there is not witness', function(){
      var demoArticle = bonzo.create('<div class="article article--standard" id="standard-article-container">        <div class="article__header" id="article-header">            <div class="section section__container" id="section"><div class="content__labels">World</div><div class="content__series-label content__labels"><a href="x-gu://list/"><span> </span></a></div></div>            <h1 class="headline selectable" id="headline">Cuba ferry services to resume from US </h1>            <div class="standfirst selectable" id="standfirst"><p>Florida operators receive approval to relaunch services to Havana as island prepares to officially receive American tourists after 56 years </p></div>            <div class="meta" id="meta">                <div class="meta__misc">                    <div class="meta__byline">                        <a class="alerts " href="x-gu://follow/tag-contributor///profile/jessica-elgot" data-follow-alert-id="tag-contributor///profile/jessica-elgot">    <span class="alerts__state--unfollow">        <span data-icon="" aria-hidden="true"></span>        <span class="alerts__label">Follow contributor</span>    </span>    <span class="alerts__state--follow">        <span data-icon="" aria-hidden="true"></span>        <span class="alerts__label">Following contributor</span>    </span></a>                        <span class="byline" id="byline"><span class="byline__author" id="byline-author"><a href="x-gu://list/localhost/lists/tag/profile/jessica-elgot">Jessica Elgot</a></span></span>                    </div>                    <p class="meta__pubdate"><span class="screen-readable" id="pubdate">Published: </span>14:27 GMT+1 Wednesday, 06 May 2015</p>                </div>                <div class="meta__comments">    <a href="#comments" data-scroll="">        <span data-icon="" aria-hidden="true"></span> 4        <span class="meta__comments__label">Comments</span>    </a></div>            </div>            <div class="main-media" id="main-media">                <figure class="element element-placeholder figure-wide">    <a class="element__inner" href="x-gu://playvideo/cdn.theguardian.tv/HLS/2015/05/06/20150506CubaFerry_FromGuAmRM/20150506CubaFerry_FromGuAmRM.m3u8">        <img src="http://images.mobile-apps.guardianapis.com/static/sys-images/Guardian/Pix/pictures/2015/5/6/1430921200377/Ferry-from-Havana-to-Flor-004.jpg?width=2000&amp;height=1200&amp;quality=60" style="width: 100%;">        <span class="element-placeholder__button touchpoint">            <span class="touchpoint__button" data-icon="" aria-hidden="true" id="video-play-button"></span>            <span class="touchpoint__label"><span class="screen-readable">Play Video. Duration: </span>00:52</span>        </span>    </a></figure>            </div>            <div class="extras">                 <div class="sponsorship"> <p class="sponsorship__formatted-sponsor-name">   <span>Guardian Cities is supported by: </span><a href="http://www.100resilientcities.org">The Rockefeller Foundation</a>  </p>  <a class="sponsorship__about-uri" href="x-gu://item/mobile-apps.guardianapis.com/items/cities/2014/jan/27/cities-about-this-site">    About this content  </a></div>            </div>        </div>        <div class="article__body" id="article-body">            <div class="from-content-api prose resizable selectable" id="article-body-blocks">                <div class="advert-slot advert-slot--mpu advert-slot--mpu--tablet"><div class="advert-slot__label">Advertisement<a class="advert-slot__action" href="x-gu://subscribe">Hide<span data-icon=""></span></a></div><div class="advert-slot__wrapper" id="advert-slot__wrapper"><div class="advert-slot__wrapper__content" id="advert-mpu-content"></div></div></div><p>When ferry services last ran to Cuba from the US, Mack the Knife was in the charts and there were no McDonald’s restaurants outside America. </p> <p>Cuba still doesn’t have a branch of the burger chain – well, outside of Guantánamo Bay – but it could soon have its ferry back after more than half a century, as the Obama administration approved the reinstatement of a service between Florida and Havana.</p> <p>Cuba is yet to approve any immediate recommencement of the service, and it is unclear if the administration there would look favourably on a significant new route for people and goods to move between the US and its island neighbour. </p> <p>But things are moving on the US end. Baja Ferries, a Mexico-based passenger service, has received a licence from the US Treasury Department to run an overnight service. </p> <p><a href="http://www.sun-sentinel.com/business/tourism/fl-havana-ferry-approval-20150505-story.html">The Sun-Sentinel newspaper in Florida</a> reported approvals had also been received by Havana Ferry Partners, of Fort Lauderdale; United Caribbean Lines Florida, in the Orlando area; and Airline Brokers Co, of Miami.</p> <p><a href="https://www.facebook.com/pages/Havana-Ferry-Partners-LLC/215566788505329?fref=ts">Havana Ferry Partners wrote on its Facebook page</a>: “This is a historical event. Thanks to President Barack Obama, to whom we are very grateful, for his leadership.” </p> <p>Airline Brokers posted its approval notice on its Facebook page, adding that it had waited since 1991.</p> <figure class="element element-image figure-wide" data-media-id="cf42050a3415c78727f3f709d7f28ca58339e938">  <a href="x-gu://gallery/http://images.mobile-apps.guardianapis.com/media/cf42050a3415c78727f3f709d7f28ca58339e938/0_306_5184_3112/5184.jpg?width=#{width}&amp;height=#{height}&amp;quality=#{quality}"><img src="http://media.guim.co.uk/cf42050a3415c78727f3f709d7f28ca58339e938/0_306_5184_3112/1000.jpg" alt="Tourists take in the sights from a tour bus of Havana. Cuba is ready to welcome American visitors legally after half a century." width="1000" height="600" class="gu-image" style="width: 100%;"></a>  <figcaption>   <span class="element-image__caption">Tourists take in the sights from a tour bus of Havana. Cuba is ready to welcome American visitors legally after half a century.</span>   <span class="element-image__credit">Photograph: Joe Raedle/Getty</span>  </figcaption> </figure> <p>Robert Muse, a lawyer for Baja Ferries, told Associated Press that the new service could provide a much cheaper way for travellers to visit the two countries, and provide a vital method of transporting imported goods now legal via new loopholes in the trade embargo. <br></p> <p>Muse said it was “a further indication of the seriousness of the Obama administration in normalising relations with Cuba, we’re now going from the theoretical to the very specific”.</p> <p>Before the 1959 revolution, daily ferries used to run, with tourists visiting the beachfront hotels and casinos of Havana, and the large expat Cuban community shuttling the 315 miles from south Florida to see family, friends and <a href="http://www.npr.org/2014/12/27/373393516/for-cubans-in-key-west-a-longing-to-fill-in-gaps-of-who-we-are">even seek medical or dental treatment</a>.<br></p> <p>The New York-based airline JetBlue said this week it would offer weekly flights from JFK airport to Havana from 3 July, the first carrier to announce a new service since restrictions were eased.</p> <p>For decades, private charter flights were the only way for the <a href="http://www.npr.org/blogs/parallels/2014/06/24/324898879/with-cash-and-fat-fryers-americans-feed-cubas-growing-free-market">600,000 travellers who make the journey each year</a>, 80% of them Cuban-Americans visiting relatives. But tourism is on the rise, particularly after Obama’s announcement in December that the trade embargo would be relaxed. </p> <p>Around 30,000 Americans currently travel purely for the purposes of tourism to the country every year, which is still officially illegal, although pressure groups are campaigning for this restriction to also be lifted.</p>                            </div>        </div>        <div class="tags" id="tags">            <ul class="inline-list" id="tag-list">                <li class="inline-list__item screen-readable">Tags:</li>            <li class="inline-list__item"><a href="x-gu://list/localhost/lists/tag/world/cuba">Cuba</a></li><li class="inline-list__item"><a href="x-gu://list/localhost/lists/tag/us-news/us-foreign-policy">US foreign policy</a></li><li class="inline-list__item"><a href="x-gu://list/localhost/lists/tag/us-news/us-news">US news</a></li><li class="inline-list__item"><a href="x-gu://list/localhost/lists/tag/travel/cuba">Cuba</a></li><li class="inline-list__item"><a href="x-gu://list/localhost/lists/tag/world/americas">Americas</a></li><li id="more-tags-contaier" class="inline-list__item more-button js-more-button"><a id="more">More...</a></li><li class="inline-list__item hide-tags"><a href="x-gu://list/localhost/lists/tag/travel/northandcentralamerica">North and Central America</a></li><li class="inline-list__item hide-tags"><a href="x-gu://list/localhost/lists/tag/travel/travel">Travel</a></li><li class="inline-list__item hide-tags"><a href="x-gu://list/localhost/lists/tag/world/world">World news</a></li><li class="inline-list__item hide-tags"><a href="x-gu://list/localhost/lists/tag/profile/jessica-elgot">Jessica Elgot</a></li></ul>        </div>    </div>').pop();
      $(demoArticle).appendTo(sandbox);
      Witness.duplicate();
      expect($('.witness').length).to.be.equal(0);
    });

    afterEach(function(){
      sandbox.empty();
    });

    after(function(){
      sandbox.remove();
    });

  });

});
